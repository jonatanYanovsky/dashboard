<!DOCTYPE html>
<html>

<head>
	<title>RADICAL dashboard</title>
	<meta charset="UTF-8">
</head>

<body onload="start()">

	<script>

	var plottedBefore = false;
	
	function start() {
		//var type = getPlotType();
		//document.getElementById("plotName").innerHTML = type; // set the text above the plot
		
		setInterval(server, 3000);
	}

	function getPlot() { 
		var type = localStorage.getItem("plot");
		return type;
	}

	function getPST() {
		var pst = localStorage.getItem("pst");
		return pst;
	}

	function getPlotType() {
		var plotType = localStorage.getItem("plotType");
		return plotType;
	}

	function setPlotURL(url) {
		document.getElementById("graph1").srcdoc = url;
		//url = "https://plot.ly/~Satguide2012/40";
	}

	function checkURL(url) {

		var garbage = "<!DOCTYPE HTML PUBLIC";
		// if does not contain garbage, etc
		if(url.indexOf(garbage) === -1 && url !== "sleep" && url !== "") {
			return true;
		} else {
			return false;
		}
	}

	function server() { // contacts server, requests iframe
		var req = new XMLHttpRequest(); // the request
		
		req.onload = function() {
			
			var ret = req.responseText;
			console.log(ret);

			if (checkURL(ret))
				setPlotURL(ret);
		}

		var plot = getPlot();
		var pst = getPST();
		var plotType = getPlotType();

		req.open("POST", "http://localhost:5000/", true);
		req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
 		req.send("plot=" + plot + "&pst=" + pst + "&plotType=" + plotType);
	}

	</script>


	
<h1>DASHBOARD</h1>

<p id="plotName"></p>

<div class="graphDiv">
<iframe id="graph1" scrolling='no' style="width:100%; height:600px; border:none" seamless></iframe>
<!--<iframe id="graph2" scrolling='no' style="width:0; height:0; border:none" seamless></iframe>-->
</div>
    

</body>
</html>

